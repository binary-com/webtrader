{"version":3,"sources":["../../../../src/shownotice/shownotice.es6"],"names":["events","on","init","catch","err","console","error","msg","win","triggered_by","account_status","Promise","resolve","reject","send","get_account_status","then","data","status","inArray","html","i18n","replace","append","moveToTop","createBlankWindow","title","dialogClass","width","height","resizable","collapsable","minimizable","maximizable","closable","closeOnEscape","modal","ignoreTileAction","close","dialog","message"],"mappings":"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","file":"shownotice.js","sourcesContent":["import rv from 'common/rivetsExtra';\nimport $ from 'jquery';\nimport windows from 'windows/windows';\nimport liveapi from 'websockets/binary_websockets';\nimport 'common/util';\nimport 'jquery-growl';\n\nliveapi.events.on(\"login\", () => { init(\"event\").catch((err) => { console.error(err.msg) }) });\nliveapi.events.on(\"buy\", () => { init(\"event\").catch((err) => { console.error(err.msg) }) });\nlet win = null;\n//Triggered by is used to determine which fucntion invokes it.\nexport const init = (triggered_by) => {\n    let account_status = '';\n    return new Promise((resolve, reject) => {\n        liveapi.send({ get_account_status: 1 }).then((data) => {\n            const status = data.get_account_status.status;\n            let msg = '';\n            if ($.inArray(\"authenticated\", status) !== -1) {\n                if ($.inArray(\"unwelcome\", status) !== -1) {\n                    account_status = \"withdrawal_allowed\";\n                    msg = $(\"<span/>\", {\n                        html: \"Your account is currently suspended. Only withdrawals are now permitted. For further information, please contact %1.\"\n                            .i18n().replace(\"%1\", \"<a href=\\\"mailto:support@binary.com\\\">support@binary.com</a>\")\n                    });\n                } else if ($.inArray(\"cashier_locked\", status) !== -1) {\n                    account_status = \"cashier_locked\";\n                    msg = $(\"<span/>\", {\n                        html: \"Deposits and withdrawal for your account is not allowed at this moment. Please contact %1 to unlock it.\"\n                            .i18n().replace(\"%1\", \"<a href=\\\"mailto:support@binary.com\\\">support@binary.com</a>\")\n                    });\n                } else if ($.inArray(\"withdrawal_locked\", status) !== -1) {\n                    account_status = \"withdrawal_locked\";\n                    msg = $(\"<span/>\", {\n                        html: \"Withdrawal for your account is not allowed at this moment. Please contact %1 to unlock it.\"\n                            .i18n().replace(\"%1\", \"<a href=\\\"mailto:support@binary.com\\\">support@binary.com</a>\")\n                    });\n                }\n            } else if ($.inArray(\"unwelcome\", status) !== -1) {\n                account_status = \"locked\"\n                msg = $(\"<span/>\", {\n                    html: \"To authenticate your account, kindly email the following to %1:\"\n                        .i18n().replace(\"%1\", \"<a href=\\\"mailto:support@binary.com\\\">support@binary.com</a>\")\n                });\n                msg.append($(\"<ul class=\\\"checked\\\">\").append($(\"<li>\", { html: \"A scanned copy of your passport, driving licence (provisional or full) or identity card, showing your name and date of birth. Your document must be valid for at least 6 months after this date.\".i18n() }),\n                    $(\"<li>\", { html: \"A scanned copy of a utility bill or bank statement (no more than 3 months old).\".i18n() })));\n            }\n            if (msg) {\n                if (win) {\n                    win.moveToTop();\n                    reject({ msg: \"Problem with account\" });\n                    return;\n                }\n                msg = $(\"<div class='notice-msg' />\").append(msg);\n                win = windows.createBlankWindow($(\"<div/>\").append(msg).i18n(), {\n                    title: \"Notice Message\".i18n(),\n                    dialogClass: \"dialog-message\",\n                    width: 700,\n                    height: 'auto',\n                    resizable: false,\n                    collapsable: false,\n                    minimizable: false,\n                    maximizable: false,\n                    closable: true,\n                    closeOnEscape: false,\n                    modal: true,\n                    ignoreTileAction: true,\n                    close: () => {\n                        win.dialog('destroy');\n                        win = null;\n                    }\n                });\n                if (triggered_by === \"event\" && (account_status === \"locked\" || account_status === \"withdrawal_allowed\")) {\n                    win.dialog(\"open\");\n                    reject({ message: \"Problem with account\" });\n                }\n                if (triggered_by === \"withdrawal\" && account_status !== \"withdrawal_allowed\") {\n                    win.dialog(\"open\");\n                    reject({ message: \"Withdrawal not allowed\" });\n                }\n                if (triggered_by === \"deposit\" && (account_status === \"locked\" || account_status === \"cashier_locked\")) {\n                    win.dialog(\"open\");\n                    reject({ message: \"Deposit not allowed\" });\n                }\n            } else {\n                resolve();\n            }\n        });\n    });\n}\n\nexport default {\n    init\n}\n"]}
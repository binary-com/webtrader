{"version":3,"sources":["../../../../src/trade/tradeConf.es6"],"names":["require","barsTable","binders","priority","bind","el","model","chart","Highcharts","Chart","title","credits","enabled","type","renderTo","backgroundColor","width","getAttribute","height","tooltip","formatter","tick","array","x","xAxis","min","max","labels","yAxis","align","gridLineWidth","series","data","marker","plotOptions","scatter","enableMouseTracking","exporting","enableImages","legend","routine","ticks","addPlotLineX","options","addPlotLine","value","id","label","text","color","addPlotLineY","addPoint","index","length","last","quote","plot_x","getPlotX","plot_y","getPlotY","removePlotLine","last_1000_ticks","events","on","epoch","push","shift","register_ticks","state","extra","tick_count","symbol","purchase_epoch","buy","purchase_time","fn","add_tick","findIndex","t","decimal_digits","digits_after_decimal","pip","number","utc","format","symbol_name","update_status","update","back","visible","off","proposal_open_contract","forget","contract_id","category","entry","expiry","tracking_timeout_set","track_ticks","filter","forEach","setTimeout","contract","entry_tick_time","tick_interval","init","show_callback","hide_callback","root","i18n","getbarrier","barrier","includes","category_display","toFixed","message","longcode","balance_after","buy_price","start_time","transaction_id","payout","currency","potential_profit","potential_profit_text","show_result","spreads","amount_per_point","stop_loss_level","stop_profit_level","average","sum","i","avg","inx","digits_value","status","chart_visible","show_tick_chart","arrow","waiting","won","lost","sell_expired","first_quote","head","last_quote","display","css","Digits","matches","differs","over","under","odd","even","rise","fall","higher","lower","Asians","onclick","e","$target","target","hasClass","addClass","viewTransaction","then","removeClass","view"],"mappings":"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","file":"tradeConf.js","sourcesContent":["ï»¿/*\n * Created by amin on December 4, 2015.\n */\n\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport moment from 'moment';\nimport liveapi from '../websockets/binary_websockets';\nimport rv from '../common/rivetsExtra';\nimport chartingRequestMap from '../charts/chartingRequestMap';\nimport html from 'text!../trade/tradeConf.html';\nimport 'css!../trade/tradeConf.css';\n\nrequire(['websockets/stream_handler']);\nconst barsTable = chartingRequestMap.barsTable;\n\n/* rv binder to show tick chart for this confirmation dialog */\nrv.binders['tick-chart'] = {\n   priority: 65, /* a low priority to apply last */\n   bind: function(el) {\n      const model = this.model;\n      el.chart = new Highcharts.Chart({\n         title: '',\n         credits: {enabled: false},\n         chart: {\n            type: 'line',\n            renderTo: el,\n            backgroundColor: null, /* make background transparent */\n            width: (el.getAttribute('width') || 350)*1,\n            height: (el.getAttribute('height') || 120)*1,\n         },\n         tooltip: {\n            formatter: function () {\n               const tick = model.array[this.x-1];\n               return (tick && tick.tooltip) || false;\n            }\n         },\n         xAxis: {\n            type: 'linear',\n            min: 1,\n            max: el.getAttribute('tick-count')*1 + 1 /* exist spot vertical plot will not be at the end */,\n            labels: { enabled: false, }\n         },\n         yAxis: {\n            labels: { align: 'left', x: 0, },\n            title: '',\n            gridLineWidth: 0,\n         },\n         series: [\n            { data: [] },\n            /* HighChart scales the y-axis automatically based on the maximum value of data.\n             * but it doesn't consider the plotLine's value in its calculations.\n             * We add an invisible seri and late plotline values to work around this issue. */\n            {\n               type: 'scatter',\n               marker: { enabled: false },\n               data: []\n            }\n         ],\n         plotOptions: { scatter: { enableMouseTracking: false } },\n         exporting: {enabled: false, enableImages: false},\n         legend: {enabled: false},\n      });\n   }, \n   routine: function(el, ticks){\n      const model = this.model;\n      const addPlotLineX = (chart, options) => {\n         chart.xAxis[0].addPlotLine({\n            value: options.value,\n            id: options.id || options.value,\n            label: {text: options.label || 'label'},\n            color: options.color || '#e98024',\n            width: options.width || 2,\n         });\n      };\n\n      const addPlotLineY = (chart,options) => {\n         chart.yAxis[0].addPlotLine({\n            id: options.id || options.label,\n            value: options.value,\n            label: {text: options.label, align: 'center'},\n            color: 'green',\n            width: 2,\n         });\n\n         /* Add plotline value to invisible seri to make the plotline always visible. */\n         chart.series[1].addPoint([1, options.value*1]);\n      };\n\n      const index = ticks.length;\n      if(index == 0) return;\n\n      const tick = _.last(ticks);\n      el.chart.series[0].addPoint([index, tick.quote*1]);\n\n      const plot_x = model.getPlotX(); // could return null\n      plot_x && addPlotLineX(el.chart,plot_x);\n      const plot_y = model.getPlotY(); // could return null\n      plot_y && el.chart.yAxis[0].removePlotLine(plot_y.id);\n      plot_y && addPlotLineY(el.chart, plot_y);\n\n   } /* end of routine() */\n};\n\nconst last_1000_ticks = []; /* record the last 1k ticks returned */\nliveapi.events.on('tick', (data) => {\n   const tick = data.tick;\n   tick.quote *= 1;\n   tick.epoch *= 1;\n   last_1000_ticks.push(tick);\n   if(last_1000_ticks.length > 1000)\n      last_1000_ticks.shift();\n});\n\nconst register_ticks = (state, extra) => {\n   let tick_count = extra.tick_count * 1,\n      symbol = extra.symbol,\n      purchase_epoch = state.buy.purchase_time * 1,\n      fn = null;\n\n   /* No need to worry about WS connection getting closed, because the user will be logged out */\n   const add_tick = (tick) =>{\n      if (_.findIndex(state.ticks.array, (t) => (t.epoch*1 === tick.epoch*1)) === -1 && tick_count > 0) {\n         const decimal_digits = chartingRequestMap.digits_after_decimal(extra.pip, symbol);\n         state.ticks.array.push({\n            quote: tick.quote,\n            epoch: tick.epoch,\n            number: state.ticks.array.length + 1,\n            tooltip: moment.utc(tick.epoch*1000).format(\"dddd, MMM D, HH:mm:ss\") + \"<br/>\" +\n            extra.symbol_name + \" \" + tick.quote,\n            decimal_digits : decimal_digits\n         });\n         --tick_count;\n         if (tick_count === 0) {\n            state.ticks.update_status();\n            state.buy.update();\n            /* show buy-price final and profit & update title */\n            state.back.visible = true;\n            /* show back button */\n            liveapi.events.off('proposal_open_contract', fn);\n            liveapi.proposal_open_contract.forget(extra.contract_id);\n            /* unregister from proposal_open_contract stream */\n         }\n         /* update state for each new tick in Up/Down && Asians contracts */\n         if (state.ticks.category !== 'Digits')\n            state.ticks.update_status();\n      }\n   }\n\n   let entry = null, expiry = null;\n   let tracking_timeout_set = false;\n   const track_ticks = () => {\n      tracking_timeout_set = false;\n      last_1000_ticks.filter(\n         (tick) => (tick.symbol === extra.symbol && tick.epoch*1 >= entry && tick.epoch*1 <= expiry)\n      ).forEach(add_tick);\n      if(tick_count > 0) {\n         tracking_timeout_set = true;\n         setTimeout(track_ticks, 300);\n      }\n   }\n\n   fn = liveapi.events.on('proposal_open_contract', (data) => {\n      const contract = data.proposal_open_contract;\n      if(contract.contract_id !== extra.contract_id) return;\n      entry = contract.entry_tick_time ? contract.entry_tick_time * 1 : entry;\n      const tick_interval = last_1000_ticks[1].epoch*1 - last_1000_ticks[0].epoch*1;\n      // contract.date_epxiry is WRONG with odd numbers.\n      // DONT TRUST BACKEND! I'm really angry right now :/\n      expiry = entry +  (tick_interval * (extra.tick_count-1));\n      if(!tracking_timeout_set)\n         track_ticks();\n      return;\n   });\n}\n\n/** @param data\n*  @param extra = {\n*    currency: ,\n*    symbol: \"frxXAUUSD\",\n*    symbol_name: \"Gold/USD\",\n*    category: ,\n*    category_display: ,\n*    duration_unit: ,\n*      pip: \"0.001\",\n*   }\n* @param show_callback\n* @param hide_callback\n**/\nexport const init = (data, extra, show_callback, hide_callback) => {\n   const root = $(html).i18n();\n   const buy = data.buy;\n   const decimal_digits = chartingRequestMap.digits_after_decimal(extra.pip, extra.symbol);\n   extra.getbarrier = (tick) => {\n      let barrier = tick.quote*1;\n      if(extra.barrier && _(['higher','lower']).includes(extra.category_display)) {\n         barrier += extra.barrier*1;\n      }\n      return barrier.toFixed(decimal_digits);\n   }\n   const state = {\n      title: {\n         text: 'Contract Confirmation'.i18n(),\n      },\n      buy: {\n         barrier: null,\n         message: buy.longcode,\n         balance_after: buy.balance_after,\n         buy_price: buy.buy_price,\n         purchase_time: buy.purchase_time,\n         start_time: buy.start_time,\n         transaction_id: buy.transaction_id,\n         payout: buy.payout,\n         currency: extra.currency,\n         potential_profit : buy.payout - buy.buy_price,\n         potential_profit_text : 'Profit'.i18n(),\n         show_result: false,\n      },\n      spreads: {\n         amount_per_point: buy.amount_per_point || '0',\n         stop_loss_level: buy.stop_loss_level || '0',\n         stop_profit_level: buy.stop_profit_level || '0',\n      },\n      ticks: {\n         array: [],\n         average: () => {\n            const ticks = state.ticks;\n            const array = ticks.array;\n            let sum = 0;\n            for(let i = 0; i < array.length; ++i)\n               sum += array[i].quote*1;\n            const avg = sum / (array.length || 1);\n            return avg;\n         },\n         getPlotX: () => {\n            const ticks = state.ticks;\n            const inx = ticks.array.length;\n            if(inx === 1) return {value: inx, label: 'Entry Spot'.i18n()};\n            if(inx === ticks.tick_count) return {value:inx, label: 'Exit Spot'.i18n()}\n            return null;\n         },\n         getPlotY: () => {\n            const ticks = state.ticks;\n            const inx = ticks.array.length;\n            const tick = ticks.array[inx-1];\n            if(ticks.category === 'Up/Down' && inx === 1) {\n               const barrier = extra.getbarrier(tick);\n               state.buy.barrier = barrier; /* update barrier value to show in confirm dialog */\n               return {value: barrier*1, label:'Barrier ('.i18n() +barrier+')', id: 'plot-barrier-y'};\n            }\n\n            if(ticks.category === 'Asians') {\n               //https://trello.com/c/ticslmb4/518-incorrect-decimal-points-for-asian-average\n               const avg = ticks.average().toFixed(decimal_digits + 1);\n               return {value: avg, label:'Average ('.i18n() + avg + ')', id: 'plot-barrier-y'};\n            }\n            return null;\n         },\n         tick_count: extra.tick_count,\n         value: (extra.digits_value || '0') + '', // last digit value selected by the user\n         category: extra.category,\n         category_display: extra.category_display,\n         status: 'waiting', /* could be 'waiting', 'lost' or 'won' */\n         chart_visible: extra.show_tick_chart,\n      },\n      arrow: {\n         visible: !extra.show_tick_chart && extra.category !== 'Digits',\n      },\n      back: { visible: false }, /* back buttom */\n   };\n\n   state.buy.update = () => {\n      const status = state.ticks.status;\n      state.title.text = { waiting: 'Contract Confirmation'.i18n(),\n         won : 'This contract won'.i18n(),\n         lost: 'This contract lost'.i18n()\n      }[status];\n      if(status === 'lost') {\n         state.buy.potential_profit = -state.buy.buy_price;\n         state.buy.payout = 0;\n         state.buy.potential_profit_text = 'Lost';\n      }\n      if(status === 'won') {\n         state.buy.balance_after = buy.balance_after*1 + state.buy.payout*1;\n         liveapi.sell_expired(); // to update balance immediately\n      }\n      state.buy.show_result = true;\n   }\n   state.ticks.update_status = () => {\n      const decimal_digits = chartingRequestMap.digits_after_decimal(extra.pip, extra.symbol);\n\n      const first_quote = _.head(state.ticks.array).quote.toFixed(decimal_digits) + '',\n         last_quote = _.last(state.ticks.array).quote.toFixed(decimal_digits) + '',\n         barrier = extra.getbarrier(_.head(state.ticks.array)) + '',\n         digits_value = state.ticks.value + '',\n         average = state.ticks.average().toFixed(5);\n      const category = state.ticks.category,\n         display = state.ticks.category_display;\n      const css = {\n         Digits: {\n            matches:  _.last(last_quote) === digits_value,\n            differs:  _.last(last_quote) !== digits_value,\n            over: _.last(last_quote)*1 > digits_value*1,\n            under: _.last(last_quote)*1 < digits_value*1,\n            odd: (_.last(last_quote)*1)%2 === 1,\n            even: (_.last(last_quote)*1)%2 === 0\n         },\n         'Up/Down': {\n            rise: last_quote*1 > first_quote*1,\n            fall: last_quote*1 < first_quote*1,\n            higher: last_quote*1 > barrier*1,\n            lower: last_quote*1 < barrier*1,\n         },\n         Asians: {\n            'asian up': average < last_quote*1,\n            'asian down': average > last_quote*1,\n         }\n      };\n      /* set the css class */\n      state.ticks.status = css[category][display] ? 'won' : 'lost';\n   }\n\n   state.back.onclick = () => hide_callback(root);\n   state.arrow.onclick = (e) => {\n      const $target = $(e.target);\n      if(!$target.hasClass('disabled')) {\n         $target.addClass('disabled');\n         require(['viewtransaction/viewTransaction'], (viewTransaction) => {\n            viewTransaction.init(extra.contract_id, extra.transaction_id)\n               .then(() => $target.removeClass('disabled'));\n         });\n      }\n   };\n\n   const view = rv.bind(root[0], state)\n\n   if(!state.arrow.visible) { register_ticks(state, extra); }\n   else { state.back.visible = true; }\n\n   show_callback(root);\n}\n\nexport default  { init }\n"]}
define(["jquery","datatables","charts/charts"],function(a){function b(b,d){require(["text!charts/indicators/indicators_remove.html"],function(e){e=a(e),c=e.hide().find("table").DataTable({paging:!1,scrollY:200,info:!1}),e.appendTo("body"),a(".indicator_remove_dialog").dialog({autoOpen:!1,modal:!0,my:"center",at:"center",width:330,of:window,resizable:!1,buttons:[{text:"Remove Selected",click:function(){var b=c.rows(".selected").data().length;if(b>0){var d=a(".indicator_remove_dialog").data("refererChartID");c.rows(".selected").nodes().to$().each(function(){var b=a(this).data("seriesID"),e=a(this).data("parentSeriesID"),f=a(this).data("id"),g=a(d).highcharts();a.each(g.series,function(c,d){if(d.options.id==e){var g=d["remove"+a.trim(f).toUpperCase()];return g.call(d,b),!1}}),c.row(a(this)).remove().draw()})}else a.growl.error({message:"Please select indicators to remove"})}},{text:"Cancel",click:function(){a(".indicator_remove_dialog").dialog("close")}}]}),a.isFunction(d)&&d(b)})}var c=void 0;return{openDialog:function(d){if(0==a(".indicator_remove_dialog").length)return void b(d,this.openDialog);c.clear().draw();var e=a(d).highcharts();e&&(e.series.forEach(function(b){if(a(b).data("isIndicator"))for(var d in b)if(a.isFunction(b[d])&&0===d.indexOf("preRemovalCheck")){var e=b[d].call(b,b.options.id);e&&e.isValidUniqueID&&e.isMainIndicator&&a(c.row.add([e.indicatorName||b.options.name]).draw().node()).click(function(){a(this).toggleClass("selected")}).data({id:d.replace("preRemovalCheck","").toUpperCase(),seriesID:b.options.id,parentSeriesID:a(b).data("parentSeriesID")})}}),a(".indicator_remove_dialog").data("refererChartID",d).dialog("open"))}}});
define(["exports","jquery","../windows/windows","../common/rivetsExtra","lodash","text!./config.html","../common/util","css!./config.css"],function(a,b,c,d,e,f){"use strict";function g(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(a,"__esModule",{value:!0}),a.init=void 0;var h=g(b),i=g(c),j=g(d),k=g(e),l=g(f),m=null,n=null,o=function(){var a=h["default"](l["default"]).i18n(),b=p(a);n=j["default"].bind(a[0],b),m=i["default"].createBlankWindow(a,{title:"Change Backend Server".i18n(),resizable:!1,collapsable:!1,minimizable:!1,maximizable:!1,modal:!0,ignoreTileAction:!0,open:function(){var a=local_storage.get("config");a&&a.app_id&&(b.app_id=a.app_id),a&&a.websocket_url&&(b.websocket_url=k["default"].replace(k["default"].replace(a.websocket_url||"","wss://",""),"/websockets/v3?l=EN","")),a&&a.oauth_url&&(b.oauth_url=k["default"].replace(k["default"].replace(a.oauth_url||"","https://",""),"/oauth2/authorize",""))},close:function(){n&&n.unbind(),m&&m.dialog("destroy").remove(),n=m=null},buttons:[{text:"Apply".i18n(),icons:{primary:"ui-icon-check"},click:b.apply},{text:"Reset to Defaults".i18n(),icons:{primary:"ui-icon-refresh"},click:b.reset}]}),m.dialog("open")},p=function(){var a={websocket_url:"ws.binaryws.com",oauth_url:"oauth.binary.com",app_id:""};return a.apply=function(){var b=(local_storage.get("i18n")||{value:"en"}).value,c={websocket_url:"wss://"+a.websocket_url+"/websockets/v3?l="+b,oauth_url:"https://"+a.oauth_url+"/oauth2/authorize",app_id:a.app_id};local_storage.set("config",c),a.reload_page()},a.reset=function(){local_storage.remove("config"),a.reload_page()},a.reload_page=function(){h["default"].growl.notice({message:"Config changes successful.<br/>Reloading page ...".i18n()}),setTimeout(function(){window.location.reload()},900)},a},q=a.init=function(a){a.click(function(){m?m.moveToTop():o()})};a["default"]={init:q}});
{"version":3,"sources":["../../../../src/navigation/navigation.es6"],"names":["updateDropdownToggles","each","unbind","on","$ul","next","css","visibility","opacity","display","class_name","attr","split","lastChild","nodeName","trigger","find","getType","id","type","MLT","MF","VRTC","REAL","match","initLoginButton","root","account_menu","time","state","show_login","local_storage","get","login_disabled","currency","logout_disabled","account","show","balance","is_virtual","show_submenu","oauth","map","e","showLoginWin","require","login_win","init","toggleVisibility","value","logout","invalidate","switchAccount","switch_account","catch","err","growl","error","message","code","console","log","bind","update_balance","data","authorize","formatPrice","events","dialog","remove","loginid","set","is_current_account_real","getLandingCompany","then","what_todo","show_financial_link","show_realaccount_link","loginids","Cookies","has_real_account","some","is_real","has_disabled_account","is_disabled","fixed","i18n","text","utc","format","setInterval","initLangButton","addBack","lang","name","confirm","visible","languages","onclick","window","location","reload","cached","send","website_status","supported_languages","m","toLowerCase","newList","intersectionBy","length","forEach","push","landing_company","country","financial","financial_company","gaming","gaming_company","curr_login","is_mlt","test","shortcode","is_mf","is_mx","is_cr","callback","prepend","is_beta","closest"],"mappings":"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","file":"navigation.js","sourcesContent":["/* Created by Armin on 10/17/2015 */\n\nimport $ from 'jquery';\nimport moment from 'moment';\nimport _ from 'lodash';\nimport liveapi from '../websockets/binary_websockets';\nimport rv from '../common/rivetsExtra';\nimport $navHtml from 'text!./navigation.html';\nimport '../common/util';\nimport 'css!navigation/navigation.css';\n\nexport const updateDropdownToggles = () => {\n   $(\"#nav-menu .nav-dropdown-toggle\").each(function(){\n      $(this).unbind(\"click\").on(\"click\",function(){\n         const $ul = $(this).next();\n         if($ul){\n            if($($ul[0]).css(\"visibility\")===\"hidden\") \n               $($ul[0]).css({visibility:\"visible\",opacity:1,display:\"block\"});\n            else \n               $($ul[0]).css({visibility:\"\",opacity:\"\",display:\"\"});\n         }\n      });\n   });\n   $(\"#nav-menu li\").each(function(){\n      const class_name = $(this).attr(\"class\") && $(this).attr(\"class\").split(\" \")[0];\n      if(class_name=== \"account\" || class_name === \"login\")\n         return;\n      $(this).unbind(\"click\").on(\"click\", function(){\n         if($(this)[0].lastChild.nodeName === \"A\"){\n            $(this).trigger(\"mouseleave\");\n         }\n      });\n      $(this).unbind(\"mouseleave\").on(\"mouseleave\",function(){\n         const $ul = $(this).find(\"ul\");\n         if($ul){\n            $($ul[0]).css({visibility:\"\",opacity:\"\",display:\"\"});\n         }\n      });\n   });\n\n}\n\nconst getType = (id) => {\n   if(!id) return;\n   const type = {MLT:\"Investment\", MF:\"Gaming\",VRTC:\"Virtual\",REAL:\"Real\"};\n   id = id.match(/^(MLT|MF|VRTC)/i) ? id.match(/^(MLT|MF|VRTC)/i)[0] : \"REAL\";\n   return type[id]+\" Account\";\n};\n\nconst initLoginButton = (root) => {\n   const account_menu = root.find('.account-menu');\n   const time = root.find('span.time');\n   const state = {\n      show_login: local_storage.get('oauth') ? false : true,\n      login_disabled: false,\n      currency: '',\n      logout_disabled: false,\n      account: {\n         show:false,\n         type:'',\n         id:'',\n         balance: '',\n         is_virtual:0\n      },\n      show_submenu: false,\n   };\n\n\n   state.oauth = local_storage.get('oauth') || [];\n   state.oauth = state.oauth.map((e) => {\n      e.type = getType(e.id);\n      return e;\n   });\n   state.showLoginWin = () => {\n      state.login_disabled = true;\n      require(['oauth/login'], (login_win) => {\n         state.login_disabled = false;\n         login_win.init();\n      });\n   };\n\n   state.toggleVisibility = (value) => {\n      state.show_submenu = value;\n   };\n\n   state.logout = () => {\n      liveapi.invalidate();\n      state.logout_disabled = true;\n   };\n\n   state.switchAccount = (id) => {\n      liveapi.switch_account(id)\n         .catch((err) => {\n            $.growl.error({message: err.message});\n            // logout user if he decided to self exclude himself.\n            if(err.code===\"SelfExclusion\"){\n               console.log(\"logging out because of self exclude\");\n               liveapi.invalidate();\n            }\n         });\n   }\n\n   rv.bind(account_menu, state);\n\n   const update_balance = (data) => {\n      if (!state.currency) {\n         /* We're not going to set currency automatically, since the user might select a different currency  */\n         if (local_storage.get(\"currency\")){\n            state.currency = local_storage.get(\"currency\");\n         } else \n            return;\n      }\n\n      let value = '0';\n      if (data.authorize) value = data.authorize.balance;\n      else value = data.balance ? data.balance.balance : '0';\n\n      state.account.balance = formatPrice(value, state.currency);\n   };\n\n   /* update balance on change */\n   liveapi.events.on('balance', update_balance);\n\n   liveapi.events.on('logout', () => {\n      $('.webtrader-dialog[data-authorized=true]').dialog('close').dialog('destroy').remove();\n      /* destroy all authorized dialogs */\n      state.logout_disabled = false;\n      state.account.show = false;\n      state.show_login = true;\n      state.account.id = '';\n      state.account.balance = '';\n      state.account.type = '';\n      state.currency = '';\n\n      local_storage.remove(\"currency\");\n   });\n\n   liveapi.events.on('login', (data) => {\n      $('.webtrader-dialog[data-authorized=true]').dialog('close').dialog('destroy').remove();\n      /* destroy all authorized dialogs */\n      state.show_login = false;\n      state.account.show = true;\n      state.account.id = data.authorize.loginid;\n      state.account.is_virtual = data.authorize.is_virtual;\n      state.oauth = local_storage.get('oauth') || [];\n      state.oauth = state.oauth.map((e) => {\n         e.type = getType(e.id);\n         return e;\n      });\n      state.account.type = getType(data.authorize.loginid);\n\n      state.currency = data.authorize.currency;\n      local_storage.set(\"currency\", state.currency);\n      update_balance(data);\n      const is_current_account_real = data.authorize.is_virtual === 0;\n\n      getLandingCompany().then((what_todo) => {\n         state.show_financial_link = (what_todo === 'upgrade-mf');\n         state.show_realaccount_link = (what_todo === 'upgrade-mlt');\n         const loginids = Cookies.loginids();\n         state.has_real_account = _.some(loginids, {is_real: true});\n         state.has_disabled_account =  _.some(loginids, {is_disabled: true});\n\n         if(_.some(loginids, {is_disabled: true})) {\n            $.growl.error({\n               fixed: true,\n               message:\"<a href='https://www.binary.com/en/contact.html' target='_blank'>\"\n               + \"Your account is locked, please contact customer support for more info.\".i18n()\n               + \"</a>\"\n            });\n         }\n      });\n   });\n\n   // Restore login-button in case of login-error\n   $('.login').on(\"login-error\", (e) => {\n      console.log(\"Encountered login error\");\n      state.show_login = true;\n   });\n\n   /* update time every one minute */\n   time.text(moment.utc().format('YYYY-MM-DD HH:mm') + ' GMT');\n   setInterval(() => {\n      time.text(moment.utc().format('YYYY-MM-DD HH:mm') + ' GMT');\n   }, 15 * 1000);\n}\n\nconst initLangButton = (root) => {\n   root = root.find('#topbar').addBack('#topbar');\n   const state = {\n      lang: {\n         value: 'en', name: 'English'\n      },\n      confirm: {\n         visible: false\n      },\n      languages: [\n         { value: 'en', name: 'English'},\n         { value: 'ar', name: 'Arabic'},\n         { value: 'de', name: 'Deutsch'},\n         { value: 'es', name: 'Español'},\n         { value: 'fr', name: 'Français'},\n         { value: 'id', name: 'Indonesia'},\n         { value: 'it', name: 'Italiano'},\n         { value: 'pl', name: 'Polish'},\n         { value: 'pt', name: 'Português'},\n         { value: 'ru', name: 'Русский'},\n         { value: 'th', name: 'Thai'},\n         { value: 'vi', name: 'Tiếng Việt'},\n         { value: 'zh_cn', name: '简体中文'},\n         { value: 'zh_tw', name: '繁體中文'}\n      ]\n   };\n\n   state.onclick = (value) => {\n      state.confirm.visible = false;\n      const lang = _.find(state.languages, {value: value});\n      if(lang.value == state.lang.value)\n         return;\n\n      local_storage.set('i18n', {value: lang.value});\n      window.location.reload();\n   };\n\n   state.toggleVisibility = (visible) => {\n      state.confirm.visible = visible;\n   }\n\n   const value = (local_storage.get('i18n') || {value: 'en'}).value;\n   state.lang = _.find(state.languages, {value: value}); // set the initial state.\n\n   rv.bind(root[0], state);\n\n   //Init the trigger of loading language list from server\n   liveapi\n      .cached\n      .send({website_status: 1})\n      .then((data) => {\n         let supported_languages = (data.website_status || {}).supported_languages || [];\n         supported_languages = _.map(supported_languages, (m) => ({value: m.toLowerCase()}));\n         const newList = _.intersectionBy(state.languages, supported_languages, 'value') || [];\n         state.languages.length = 0;\n         newList.forEach(\n            (e) => state.languages.push(e)\n         );\n      })\n      .catch(console.error)\n\n}\n\n/*\n  1: company = (gaming company) && (financial company && financial company shortcode = maltainvest)\n     a: no MLT account  ==> upgrade to MLT\n     b: has MLT account\n        I:     upgrade to MF\n    c: has both MLT & MF ==> do nothing\n  2: company = financial company &&  financial company shortcode = maltainvest) && there is NO gaming company\n     a: no MF account\n        I: company = financial ==> upgrade to MF\n     b: has MF account => do nothing\n  3: company & shortcode anything except above\n     a: no MLT, MX, CR account ==> upgrade to MLT, MX or CR\n     b: has MLT, MX, CR account ==> do nothing\n  4: company shortcode == japan\n     a: do nothing and show an error message\n\n  returns 'upgrade-mlt' | 'upgrade-mf' | 'do-nothing'\n*/\nexport const getLandingCompany = () => {\n   return liveapi.cached.authorize().then((data) => {\n      return liveapi\n         .cached.send({landing_company: data.authorize.country })\n         .then((data) => {\n            const financial = data.landing_company.financial_company;\n            const gaming = data.landing_company.gaming_company;\n\n            const loginids = Cookies.loginids();\n            const curr_login = local_storage.get(\"oauth\")[0];\n            curr_login.is_mlt = /MLT/.test(curr_login.id);\n            if (gaming && financial && financial.shortcode === 'maltainvest') { // 1:\n               if (_.some(loginids, {is_mlt: true}) && (_.some(loginids, {is_mf: true}) || !curr_login.is_mlt)) // 1-c\n                  return 'do-nothing';\n               if (_.some(loginids, {is_mlt: true})) // 1-b\n                  return 'upgrade-mf';\n               return 'upgrade-mlt'; // 1-a\n            }\n            if (financial && financial.shortcode === 'maltainvest' && !gaming) { // 2:\n               if (_.some(loginids, {is_mf: true})) // 2-b\n                  return 'do-nothing';\n               return 'upgrade-mf'; // 2-a\n            }\n            // 3:\n            if (_.some(loginids, {is_mlt: true}) || _.some(loginids, {is_mx: true}) || _.some(loginids, {is_cr: true}))\n               return 'do-nothing'; // 3-b\n            return 'upgrade-mlt'; // 3-a (calls the normal account opening api which creates an mlt, mx or cr account).\n            // 4: never happens, japan accounts are not able to log into webtrader.\n         });\n   });\n}\n\nexport const init = (callback) => {\n   const root = $($navHtml).i18n();\n   $(\"body\").prepend(root);\n\n   initLoginButton(root);\n   initLangButton(root);\n\n   //Load theme settings ...\n   require(['themes/themes']);\n\n   updateDropdownToggles();\n\n   if (callback) {\n      callback($(\"#nav-menu\"));\n   }\n\n   //Show config <LI> if its production and not BETA\n   if (is_beta()) {\n      root.find(\"a.config\").closest('li').show();\n   }\n}\n\nexport default {\n   init,\n   getLandingCompany,\n   updateDropdownToggles\n};\n\n"]}